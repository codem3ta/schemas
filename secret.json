{
  "$id": "https://codemeta.de/schemas/secret",
  "title": "Secret",
  "name": "secret",
  "collection": "secrets",
  "description": "A password or other encrypted secret. Can include an encrypted file.",
  "i18n": {
    "de": {
      "singular": "Geheimnis",
      "plural": "Geheimnisse",
      "description": "Die Objekte enthalten verschlüsselte Nachrichten. Zum Lesen ist zusätzlich der Schlüssel aus dem Link erforderlich."
    }
  },
  "type": "object",
  "properties": {
    "secret": {
      "description": "The encrypted secret",
      "type": "array",
      "items": { "type": "integer", "minimum": 0, "maximum": 255 }
    },
    "iv": {
      "description": "The initialization vector for the secret (12 bytes recommended, 16 bytes supported for legacy)",
      "type": "array",
      "items": { "type": "integer", "minimum": 0, "maximum": 255 },
      "minItems": 12,
      "maxItems": 16
    },
    "notify": {
      "description": "The email address to be notified once the secret has been opened.",
      "type": "string",
      "format": "email"
    },
    "attachments": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "description": "The ID of the attachment",
            "type": "string"
          },
          "iv": {
            "description": "The initialization vector for the file content (12 bytes). If not present, falls back to secret.iv for legacy support.",
            "type": "array",
            "items": { "type": "integer", "minimum": 0, "maximum": 255 },
            "minItems": 12,
            "maxItems": 12
          },
          "filenameIv": {
            "description": "The initialization vector for the encrypted filename (12 bytes). If not present, falls back to secret.iv for legacy support.",
            "type": "array",
            "items": { "type": "integer", "minimum": 0, "maximum": 255 },
            "minItems": 12,
            "maxItems": 12
          },
          "filename": {
            "description": "The encrypted filename",
            "type": "array",
            "items": { "type": "integer", "minimum": 0, "maximum": 255 }
          },
          "type": {
            "description": "The MIME type of the attachment",
            "type": "string"
          },
          "size": {
            "description": "The size of the attachment in bytes",
            "type": "integer",
            "minimum": 0
          }
        },
        "required": ["filename", "type", "size"],
        "additionalProperties": false
      }
    }
  },
  "readOnce": true
}